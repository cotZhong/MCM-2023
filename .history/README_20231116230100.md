# MCM 2023
## 研究生数学建模竞赛:解决方案与报告

出血性脑卒中指非外伤性脑实质内血管破裂引起的脑出血，其特点表现为起病急、进展快，预后较差，急性期内病死率高达45-50%，约80%的患者会遗留较严重的神经功能障碍，为社会及患者家庭带来沉重的健康和经济负担。因此，整合影像学特征、患者临床信息及临床诊疗方案，智能化分诊发掘出血性脑卒中的发病风险，精准预测患者预后，并据此优化临床决策具有重要的临床意义。

针对问题一：我们对血脉扩张风险相关因素进行探索建模。为了判断sub001至sub100发病后48个小时内是否发生血肿扩张事件，将所有随访流水号作为ID，将当前随访血肿体积前后变化与其距离发病的时间间隔作为判断条件，得到结果并记录血脉扩张时间。利用a小问判断结果，结合患者个人史，疾病史等临床信息和首次影像结果进行特征工程，我们预测了所有患者发生血肿扩张的概率。首先，我们对72个特征建立特征工程，描述性统计并利用GBDT和XGBoost算法加权进行特征重要性排序，选取前19个特征进行建模预测，使用十折交叉验证方法并尝试采用Logistic模型、GBDT、XGBoost、LightGBM、随机森林和支持向量机6个模型。最后，基于Stacking的集成方法，我们根据AUC选取其中表现最优的三个模型进行集成，发现我们改进的**Stacking集成模型**具有最优的表现，在验证集上表现了最高的预测精度。

针对问题二：我们对血肿周围水肿的发生及进展建模，并对治疗干预和水肿进展进行关联关系探索。首先，为构建一条全体患者水肿体积随时间进展曲线，我们利用n次多项式拟合函数和指数函数，针对不同时间段分布特点进行分段回归，并得到真实值和所拟合曲线之间的残差。由于水肿体积随时间变化存在较大个体差异，针对不同个体检查时间点的差异，我们通过对个体水肿体积随时间变化曲线进行二次函数拟合，利用拐点等信息提取了其时序特征，并结合个体水肿相对位置变化情况，进行Kmeans聚类，根据轮廓系数，我们选取了合适的K值，最后得到4组人群，并对各组人群分别进行了拟合。此外，为了探索干预分配和水肿进展的关系，针对本观测性实验小样本的特点，我们使用因果推断中的**倾向得分匹配方法（PSM）**，对治疗人群进行一对一匹配，根据水肿、血肿体积进展曲线特征构建指标。最后，根据对治疗组和对照组进行双样本t检验，得出降压治疗对减缓血肿体积扩张和抑制水肿体积变化都效果显著，止血治疗对发病阶段水肿扩张具有抑制作用。同时，通过计算相关系数绘制热力图发现血肿体积和水肿体积显著相关。

针对问题三：考虑到患者的随访次数不固定，随访时间间隔不相等，我们考虑引入了基于**集成残差学习**的非均匀动态面板预测框架，在不同时间维度，我们将患者的随访信息输入进模型以学习残差，以提升对mRS预测的精度。为对患者高维特征进行挖掘，我们引入特征消融实验，来评价特征的复杂非线性关系。此外，我们提出了基于贪心算法的预后多特征关联规则挖掘，极大降低了挖掘算法的时间复杂度，发现了不同特征组合对患者mRS的影响程度。


## file tree
│  README.md
│  requirements.txt 
│  摘要.txt
├─code
│      3b.ipynb
│      3b_tmp.ipynb
│      get_2cd_data.ipynb
│      q_1_b2_pre_processing.ipynb
│      q_1_pre_processing.ipynb
│      q_2_a.ipynb
│      q_2_b.ipynb
│      
├─plots
│      01组拟合.png
│      23组拟合.png
│      3b二维特征消融.png
│      3b特征工程.png
│      3b特征相关性.png
│      不同亚种水肿体积随时间进展曲线.png
│      发病季节与发病时间.png
│      拟合残差.png
│      检查时间间隔与随访次数.png
│      检查次数与检查时间间隔.png
│      水肿体积随时间进展.png
│      水肿体积随时间进展曲线.png
│      水肿体积随时间进展曲线预测残差.png
│      特征消融实验.png
│      血肿扩张情况.png
│      血肿扩张情况_年龄.png
│      血肿扩张情况_性别.png
│      血肿扩张情况_治疗.png
│      血肿扩张情况_病史.png
│      轮廓系数与簇数.png
│      
└─竞赛发布数据
        2cd_Data.csv
        2cd_Data.csv_checkpoint251648
        2cd_Data_HM.csv
        2cd_HM.csv
        all_data.xlsx
        ED_ts_feature.csv
        res_3b.csv
        res_3b_rawmodels.csv
        res_3b_resmodels.csv
        res_3b_train.csv
        solution_1a.csv
        solution_1a_checkpoint_231153.csv
        solution_1a_checkpoint_241205.csv
        solution_2a.csv
        solution_2b.csv
        表1-患者列表及临床信息.xlsx
        表2-long.csv
        表2-患者影像信息血肿及水肿的体积及位置.xlsx
        表3-患者影像信息血肿及水肿的形状及灰度分布.xlsx
        表4-答案文件.xlsx
        附表1-long.csv
        附表1-检索表格-流水号vs时间(1).xlsx
        附表1-检索表格-流水号vs时间.xlsx



